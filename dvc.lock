schema: '2.0'
stages:
  ByDay_to_Entire:
    cmd:
    - python -m src.data.ByDay_to_Entire data/raw/transactions data/interim/transactions.csv
    deps:
    - path: data/raw/transactions
      hash: md5
      md5: 2dc18d7fb8606e535dbda68a9143eeab.dir
      size: 14103817058
      nfiles: 61
    - path: src/data/ByDay_to_Entire.py
      hash: md5
      md5: 08bb7d017b051256e8d0879de8551536
      size: 1062
    outs:
    - path: data/interim/transactions.csv
      hash: md5
      md5: 45c62350eea42a912953c01ef588de3b
      size: 14371496029
  Entire_to_ByID:
    cmd:
    - python -m src.data.Entire_to_ByID data/interim/transactions.csv data/raw/beeline_antispam_hakaton_id_samples.csv
      data/interim/transactions_by_id
    deps:
    - path: data/interim/transactions.csv
      hash: md5
      md5: 45c62350eea42a912953c01ef588de3b
      size: 14371496029
    - path: data/raw/beeline_antispam_hakaton_id_samples.csv
      hash: md5
      md5: 942a8d2f60373d518885e7b69d107038
      size: 835521
    - path: src/data/Entire_to_ByID.py
      hash: md5
      md5: b2bfb9b94900a8da2264f3401ea73635
      size: 1339
    outs:
    - path: data/interim/transactions_by_id/test
      hash: md5
      md5: 69c5363bbdd0c4d03bf4458f530ded8c.dir
      size: 5229557182
      nfiles: 7103
    - path: data/interim/transactions_by_id/train
      hash: md5
      md5: a5f6b6148fdfbe12bf9891eea043df97.dir
      size: 9145197027
      nfiles: 28313
  aggregation:
    cmd:
    - python -m src.data.aggregation data/interim/transactions.csv data/interim/aggregated.csv
    deps:
    - path: data/interim/transactions.csv
      hash: md5
      md5: 45c62350eea42a912953c01ef588de3b
      size: 14371496029
    - path: src/data/aggregation.py
      hash: md5
      md5: ae84a5049dde5d0d05aa1a9e7f0302ae
      size: 2781
    outs:
    - path: data/interim/aggregated.csv
      hash: md5
      md5: 4618baa80a9c19c70caca177cc87a8af
      size: 5737178
  data_splitting:
    cmd:
    - python -m src.data.data_splitting data/interim/aggregated.csv data/raw/beeline_antispam_hakaton_id_samples.csv
      data/processed
    deps:
    - path: data/interim/aggregated.csv
      hash: md5
      md5: 4618baa80a9c19c70caca177cc87a8af
      size: 5737178
    - path: data/raw/beeline_antispam_hakaton_id_samples.csv
      hash: md5
      md5: 942a8d2f60373d518885e7b69d107038
      size: 835521
    - path: src/data/data_splitting.py
      hash: md5
      md5: 7c5d859b9b16bea126361fab7c185732
      size: 1048
    outs:
    - path: data/processed/test_data.csv
      hash: md5
      md5: 3a84709639d77740546e4fcdb2853c1a
      size: 1135877
    - path: data/processed/train_data.csv
      hash: md5
      md5: 272b85a20a53e9353e3c771aded6a08d
      size: 4637396
  train_catboost:
    cmd:
    - python -m src.models.train_catboost data/processed/train_data.parquet models/catboost.cbm
    deps:
    - path: data/processed/train_data.parquet
      hash: md5
      md5: 2d56ef5dd42ea2bb86f6da9af6b242c3
      size: 2005023
    - path: src/models/train_catboost.py
      hash: md5
      md5: 9100310535109a898e1aeedad55ad650
      size: 693
    outs:
    - path: models/catboost.cbm
      hash: md5
      md5: 16497547c8ef4f2949e9da2bd2f7ce96
      size: 1633232
  get_features_from_id_b:
    cmd:
    - python -m src.features.get_features_from_id_dst data/interim/transactions.csv
      data/interim/aggregated_features/features_from_id_dst.csv
    deps:
    - path: data/interim/transactions.csv
      hash: md5
      md5: 95df73250fcc306205d0101c776b5afc
      size: 14371496035
    - path: src/features/get_features_from_id_dst.py
      hash: md5
      md5: eb4ebf5ef084e27b951af28617dd7729
      size: 691
    outs:
    - path: data/interim/aggregated_features/features_from_id_dst.csv
      hash: md5
      md5: d6fb89d57782bc759284f29eca87e151
      size: 463602
  get_features_from_datetime:
    cmd:
    - python -m src.features.get_features_from_datetime data/interim/transactions.parquet
      data/interim/aggregated_features/features_from_datetime.parquet
    deps:
    - path: data/interim/transactions.parquet
      hash: md5
      md5: 4e9fbbe08dc15c7d220cc68eb7680d5b
      size: 3225793936
    - path: src/features/get_features_from_datetime.py
      hash: md5
      md5: 4f2acdbb056578420c3a7e47b4482de0
      size: 1226
    outs:
    - path: data/interim/aggregated_features/features_from_datetime.parquet
      hash: md5
      md5: 4e95bae13a23492f4724b4a791e9033c
      size: 899603
  get_features_from_time_zone:
    cmd:
    - python -m src.features.get_features_from_time_zone data/interim/transactions.parquet
      data/interim/aggregated_features/features_from_time_zone.parquet
    deps:
    - path: data/interim/transactions.parquet
      hash: md5
      md5: 4e9fbbe08dc15c7d220cc68eb7680d5b
      size: 3225793936
    - path: src/features/get_features_from_time_zone.py
      hash: md5
      md5: 0c675ff56fc27a45604377360f891a99
      size: 767
    outs:
    - path: data/interim/aggregated_features/features_from_time_zone.parquet
      hash: md5
      md5: 0e9d0b16df0b4875f1a37e9be3c64d26
      size: 267439
  get_features_from_duration:
    cmd:
    - python -m src.features.get_features_from_duration data/interim/transactions.parquet
      data/interim/aggregated_features/features_from_duration.parquet
    deps:
    - path: data/interim/transactions.parquet
      hash: md5
      md5: 4e9fbbe08dc15c7d220cc68eb7680d5b
      size: 3225793936
    - path: src/features/get_features_from_duration.py
      hash: md5
      md5: 3dbac1b4ba461cb4e6ec37299f3008da
      size: 1073
    outs:
    - path: data/interim/aggregated_features/features_from_duration.parquet
      hash: md5
      md5: c0773f1281844a2f30ff3fa37cae314f
      size: 932065
  get_features_from_forward:
    cmd:
    - python -m src.features.get_features_from_forward data/interim/transactions.parquet
      data/interim/aggregated_features/features_from_forward.parquet
    deps:
    - path: data/interim/transactions.parquet
      hash: md5
      md5: 4e9fbbe08dc15c7d220cc68eb7680d5b
      size: 3225793936
    - path: src/features/get_features_from_forward.py
      hash: md5
      md5: 7f7e6f5c005e8b1ab2504c1d19b19a38
      size: 802
    outs:
    - path: data/interim/aggregated_features/features_from_forward.parquet
      hash: md5
      md5: fd75c7952e9b28bbea61aab62f66cffb
      size: 408463
  get_features_from_zero_call_flg:
    cmd:
    - python -m src.features.get_features_from_zero_call_flg data/interim/transactions.parquet
      data/interim/aggregated_features/features_from_zero_call_flg.parquet
    deps:
    - path: data/interim/transactions.parquet
      hash: md5
      md5: 4e9fbbe08dc15c7d220cc68eb7680d5b
      size: 3225793936
    - path: src/features/get_features_from_zero_call_flg.py
      hash: md5
      md5: 63126109000c73270ec73f21090ab7a3
      size: 868
    outs:
    - path: data/interim/aggregated_features/features_from_zero_call_flg.parquet
      hash: md5
      md5: 21e38823c4ab274e08f45955dd772723
      size: 485125
  get_features_from_source_b:
    cmd:
    - python -m src.features.get_features_from_source_b data/interim/transactions.parquet
      data/interim/aggregated_features/features_from_source_b.parquet
    deps:
    - path: data/interim/transactions.parquet
      hash: md5
      md5: 4e9fbbe08dc15c7d220cc68eb7680d5b
      size: 3225793936
    - path: src/features/get_features_from_source_b.py
      hash: md5
      md5: 6fc88626812faf9809834e767c19ad90
      size: 811
    outs:
    - path: data/interim/aggregated_features/features_from_source_b.parquet
      hash: md5
      md5: e7cfd94253234ad1f62ec56b4691cf2f
      size: 415816
  get_features_from_source_f:
    cmd:
    - python -m src.features.get_features_from_source_f data/interim/transactions.parquet
      data/interim/aggregated_features/features_from_source_f.parquet
    deps:
    - path: data/interim/transactions.parquet
      hash: md5
      md5: 4e9fbbe08dc15c7d220cc68eb7680d5b
      size: 3225793936
    - path: src/features/get_features_from_source_f.py
      hash: md5
      md5: f0c2e65e822d860f8d9678e2ffdaaa04
      size: 811
    outs:
    - path: data/interim/aggregated_features/features_from_source_f.parquet
      hash: md5
      md5: b0d7025cd70ad7acf79afc19f7bf724d
      size: 411913
  get_features_from_num_b_length:
    cmd:
    - python -m src.features.get_features_from_num_b_length data/interim/transactions.csv
      data/interim/aggregated_features/features_from_num_b_length.csv
    deps:
    - path: data/interim/transactions.csv
      hash: md5
      md5: 45c62350eea42a912953c01ef588de3b
      size: 14371496029
    - path: src/features/get_features_from_num_b_length.py
      hash: md5
      md5: 1cb50c8677f41b18bda9715f79156a58
      size: 857
    outs:
    - path: data/interim/aggregated_features/features_from_num_b_length.csv
      hash: md5
      md5: 42aebac6e288ab759539fa2e12465941
      size: 838257
  make_and_split_dataset:
    cmd:
    - python -m src.data.make_and_split_dataset data/raw/beeline_antispam_hakaton_id_samples.csv
      data/interim/aggregated_features data/processed
    deps:
    - path: data/interim/aggregated_features
      hash: md5
      md5: 4f53f386e77cf62320737f9f8a454425.dir
      size: 4529516
      nfiles: 10
    - path: data/raw/beeline_antispam_hakaton_id_samples.csv
      hash: md5
      md5: 942a8d2f60373d518885e7b69d107038
      size: 835521
    - path: src/data/make_and_split_dataset.py
      hash: md5
      md5: 179b6e56217597f849138752fa8ce506
      size: 1727
    outs:
    - path: data/processed/test_data.parquet
      hash: md5
      md5: 7846d0ff44b7a22e9a5ed8131496d2c9
      size: 573981
    - path: data/processed/train_data.parquet
      hash: md5
      md5: 2d56ef5dd42ea2bb86f6da9af6b242c3
      size: 2005023
  by_day_to_entire:
    cmd:
    - python -m src.data.by_day_to_entire data/raw/transactions data/interim/transactions.parquet
    deps:
    - path: data/raw/transactions
      hash: md5
      md5: 2dc18d7fb8606e535dbda68a9143eeab.dir
      size: 14103817058
      nfiles: 61
    - path: src/data/by_day_to_entire.py
      hash: md5
      md5: 21d29cf007efeb34632a183da43b470e
      size: 1355
    outs:
    - path: data/interim/transactions.parquet
      hash: md5
      md5: 4e9fbbe08dc15c7d220cc68eb7680d5b
      size: 3225793936
  entire_to_by_id_src:
    cmd:
    - python -m src.data.entire_to_by_id_src data/interim/transactions.parquet data/raw/beeline_antispam_hakaton_id_samples.csv
      data/interim/transactions_by_id_src
    deps:
    - path: data/interim/transactions.parquet
      hash: md5
      md5: 4e9fbbe08dc15c7d220cc68eb7680d5b
      size: 3225793936
    - path: data/raw/beeline_antispam_hakaton_id_samples.csv
      hash: md5
      md5: 942a8d2f60373d518885e7b69d107038
      size: 835521
    - path: src/data/entire_to_by_id_src.py
      hash: md5
      md5: 49b14641b6d3303b286676e20934082f
      size: 1297
    outs:
    - path: data/interim/transactions_by_id_src/test
      hash: md5
      md5: b3a7b8edfbdf7ad9bf4ecb92dc6bfe53.dir
      size: 1136142815
      nfiles: 7103
    - path: data/interim/transactions_by_id_src/train
      hash: md5
      md5: bfdd107bdbb0e808eaaefc32609ab9dc.dir
      size: 2457269463
      nfiles: 28313
  get_features_from_num_dst_length:
    cmd:
    - python -m src.features.get_features_from_num_dst_length data/interim/transactions.parquet
      data/interim/aggregated_features/features_from_num_dst_length.parquet
    deps:
    - path: data/interim/transactions.parquet
      hash: md5
      md5: 4e9fbbe08dc15c7d220cc68eb7680d5b
      size: 3225793936
    - path: src/features/get_features_from_num_dst_length.py
      hash: md5
      md5: 60b5de5ff66c7373b8b1d7a397bff8ff
      size: 865
    outs:
    - path: data/interim/aggregated_features/features_from_num_dst_length.parquet
      hash: md5
      md5: 363f0941f45b54898dd60a60dd3ca035
      size: 389839
  get_features_from_id_dst:
    cmd:
    - python -m src.features.get_features_from_id_dst data/interim/transactions.parquet
      data/interim/aggregated_features/features_from_id_dst.parquet
    deps:
    - path: data/interim/transactions.parquet
      hash: md5
      md5: 4e9fbbe08dc15c7d220cc68eb7680d5b
      size: 3225793936
    - path: src/features/get_features_from_id_dst.py
      hash: md5
      md5: 379e96a235247ab8dbe967ab577b7a38
      size: 736
    outs:
    - path: data/interim/aggregated_features/features_from_id_dst.parquet
      hash: md5
      md5: 9142b456eb5cc0335fe88a5274ed2929
      size: 319137
